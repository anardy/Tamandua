!function(a){var b=a.sammy("#main",function(){this.use("Mustache","html");var b=Util.getUrl();this.helpers({getTipoFuncionario:function(){var a=new Sammy.Store.SessionStorage("funcionario");return a.get("tipo")},limparStoreFunc:function(){var a=new Sammy.Store.SessionStorage("funcionario");a.clear("tipo"),a.clear("cpf")}}),this.around(function(c){var d=this;this.load(b+"autentica/menuFuncionario/"+this.getTipoFuncionario()).then(function(b){d.items=a.parseJSON(b)}).then(c)}),this.get("#/",function(a){a.app.swap(""),this.trigger("menu")}),this.get("#/logout",function(a){this.limparStoreFunc(),window.location.replace("http://localhost/Tamandua/src/")}),this.get("#/funcionario",function(c){c.app.swap(""),this.trigger("menu"),this.partial("templates/funcionario.html").then(function(){a("#example").DataTable({ajax:{url:b+"funcionario",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/editarFunc/'+a+'">'+a+"</a>"}},{data:"nome"}]})})}),this.get("#/cadastroFunc",function(a){this.trigger("menu"),a.tipo="Cadastrar",this.partial("templates/formFuncionario.html")}),this.get("#/editarFunc/:cpf",function(c){c.app.swap(""),this.trigger("menu");var d=this.params.cpf;this.load(b+"funcionario/"+d,{cache:!1}).then(function(b){var d=a.parseJSON(b);c.cpf=d[0].cpf,c.nome=d[0].nome,c.tipo="Editar"}).partial("templates/formFuncionario.html")}),this.get("#/ctrAcesso",function(c){c.app.swap(""),this.trigger("menu"),this.partial("templates/ctrAcesso.html").then(function(){a("#tblCtrAcesso").DataTable({ajax:{url:b+"ctracesso",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/editarCtrAcesso/'+a+'">'+a+"</a>"}},{data:"nomeFuncionario"},{data:"nomeStatus"},{data:"nomeTipo"}]})})}),this.get("#/editarCtrAcesso/:cpf",function(c){c.app.swap(""),this.trigger("menu");var d=this.params.cpf;c.cpf=d,this.partial("templates/formCtrAcesso.html").then(function(){this.load(b+"ctracesso/tipoacesso/",{json:!0}).then(function(b){$select=a("#sltTipo"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.nome).appendTo($select)})}),this.load(b+"ctracesso/status/",{json:!0}).then(function(b){$select=a("#sltStatus"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.status).appendTo($select)})}),this.load(b+"ctracesso/"+d,{json:!0}).then(function(b){a("#sltStatus").val(b[0].status),a("#sltTipo").val(b[0].tipo)})})}),this.post("#/editarCtrAcesso",function(){var c=a("form").find('input[name="cpf"]');c.removeAttr("disabled");a("form").serialize();c.attr("disabled","disabled"),data={cpf:a("form").find('input[name="cpf"]').val(),status:a("form").find('select[name="status"]').val(),tipo:a("form").find('select[name="tipo"]').val()},a.ajax({url:b+"ctracesso",type:"PUT",data:data,success:function(a){window.location.replace("http://localhost/Tamandua/src/funcionario/#/ctrAcesso")}})}),this.get("#/desassociados",function(c){c.app.swap(""),this.trigger("menu"),this.partial("templates/desassociar.html").then(function(){a("#tblDesassociado").DataTable({ajax:{url:b+"ctracesso/desassociados",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/associar/'+a+'">'+a+"</a>"}},{data:"nome"}]})})}),this.get("#/associar/:cpf",function(c){c.app.swap(""),this.trigger("menu"),c.cpf=this.params.cpf,this.partial("templates/formAssociar.html").then(function(c){then(function(b){$select=a("#sltTipo"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.nome).appendTo($select)})}),this.load(b+"ctracesso/status/",{json:!0}).then(function(b){$select=a("#sltStatus"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.status).appendTo($select)})})})}),this.post("#/associar",function(){var c=a("form").find('input[name="cpf"]');c.removeAttr("disabled");var d=a("form").serialize();c.attr("disabled","disabled"),a.post(b+"ctracesso/associar",d,function(b){toastr.success("Funcionario "+a("form").find('input[name="cpf"]').val()+" foi associado a um perfil de acesso com sucesso!","Banco Tamandua")}).fail(function(b){result=a.parseJSON(b.responseText)})}),this.before({verb:"post",path:"#/cadastroFunc"},function(){var b=!0;return""===a("form").find('input[name="nome"]').val()?(toastr.error("O campo Nome está em branco!","Banco Tamandua"),b=!1):""===a("form").find('input[name="senha"]').val()&&(toastr.error("O campo Senha está em branco!","Banco Tamandua"),b=!1),b}),this.post("#/cadastroFunc",function(){var c=a("form").find('input[name="tipo"]').val();"Cadastrar"===c?a.post(b+"funcionario",a("form").serialize(),function(b){toastr.success("Funcionario "+a("form").find('input[name="nome"]').val()+" cadastro com sucesso!","Banco Tamandua")}).fail(function(b){result=a.parseJSON(b.responseText)}):"Editar"===c&&(data={cpf:a("form").find('input[name="cpf"]').val(),nome:a("form").find('input[name="nome"]').val(),senha:a("form").find('input[name="senha"]').val()},a.ajax({url:b+"funcionario",type:"PUT",data:data,success:function(a){window.location.replace("http://localhost/Tamandua/src/funcionario/#/funcionario")}})),a("form").find("input[type=text], input[type=password]").val(""),a("form").find("input[name=cpf]").focus()}),this.get("#/correntista",function(c){c.app.swap(""),this.trigger("menu"),this.partial("templates/corrrentista.html").then(function(){a("#tblCorrentista").DataTable({ajax:{url:b+"correntista",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/editarCorrentista/'+a+'">'+a+"</a>"}},{data:"nome"},{data:"endereco"},{data:"telefone"}]})})}),this.get("#/cadCorrentista",function(a){this.trigger("menu"),a.tipo="Cadastrar",this.partial("templates/formCorrentista.html")}),this.post("#/cadCorrentista",function(){var c=a("form").find('input[name="tipo"]').val();"Cadastrar"===c?a.post(b+"correntista",a("form").serialize(),function(b){toastr.success("Correntista "+a("form").find('input[name="cpf"]').val()+" cadastrado com sucesso!","Banco Tamandua"),a("form").find("input[type=text]").val(""),a("form").find("input[name=cpf]").focus()}).fail(function(b){result=a.parseJSON(b.responseText)}):"Editar"===c&&(data={cpf:a("form").find('input[name="cpf"]').val(),nome:a("form").find('input[name="nome"]').val(),endereco:a("form").find('input[name="endereco"]').val(),telefone:a("form").find('input[name="telefone"]').val()},a.ajax({url:b+"correntista",type:"PUT",data:data,success:function(a){window.location.replace("http://localhost/Tamandua/src/funcionario/#/correntista")}}))}),this.get("#/editarCorrentista/:cpf",function(c){c.app.swap(""),this.trigger("menu");var d=this.params.cpf;this.load(b+"correntista/"+d,{cache:!1}).then(function(b){var d=a.parseJSON(b);c.cpf=d[0].cpf,c.nome=d[0].nome,c.endereco=d[0].endereco,c.telefone=d[0].telefone,c.tipo="Editar",c.desabilita="disabled"}).partial("templates/formCorrentista.html")}),this.get("#/saldo",function(a){this.trigger("menu"),this.partial("templates/formSaldo.html")}),this.post("#/saldo",function(c){var d=a("form").find('input[name="nroconta"]').val();this.load(b+"conta/saldo/"+d).then(function(b){if(null!==b){var d=a.parseJSON(b);c.saldo="Saldo: R$ "+d[0].saldo}else c.saldo="Não foi encontrado o saldo por falta de informação"}).partial("templates/formSaldo.html")}),this.get("#/extrato",function(a){this.trigger("menu"),this.partial("templates/formExtrato.html")}),this.post("#/extrato",function(c){var d=a("form").find('input[name="nroconta"]').val();this.load(b+"conta/extrato/"+d,{json:!0}).then(function(a){for(var b in a){var e=new Date(a[b].data);a[b].fator=2===a[b].fator?"<i class='fa fa-plus'/>":"<i class='fa fa-minus'/>",a[b].data=e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes();var f="";switch(a[b].tipotransacao){case 1:f="Extrato";break;case 2:f="Transferência";break;case 3:f="Pagamento"}a[b].tipotransacao=f}if(null===a){var g="Nenhum Registro Encontrado com a conta ("+d+") informada!";c.msgm=g}else c.item=a}).partial("templates/formExtrato.html")}),this.get("#/geraConta",function(c){c.app.swap(""),this.trigger("menu"),this.partial("templates/contas.html").then(function(){a("#tblConta").DataTable({ajax:{url:b+"conta",dataSrc:""},columns:[{data:"nroconta",render:function(a,b,c,d){return'<a href="#/editarConta/'+a+'">'+a+"</a>"}},{data:"correntista"},{data:"status"}]})})}),this.get("#/cadConta",function(c){this.trigger("menu"),c.tipo="Cadastrar",this.partial("templates/formConta.html").then(function(){this.load(b+"ctracesso/status",{json:!0}).then(function(b){$select=a("#sltStatus"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.status).appendTo($select)})}),this.load(b+"correntista",{json:!0}).then(function(b){$select=a("#sltCorrentista"),a.each(b,function(b,c){a("<option>").val(c.cpf).text(c.cpf).appendTo($select)})})})}),this.get("#/editarConta/:nroconta",function(c){c.app.swap(""),this.trigger("menu");var d=this.params.nroconta;c.nroconta=d,c.tipo="Editar",c.desabilita="disabled",this.partial("templates/formConta.html").then(function(){this.load(b+"ctracesso/status",{json:!0}).then(function(b){$select=a("#sltStatus"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.status).appendTo($select)})}),this.load(b+"correntista",{json:!0}).then(function(b){$select=a("#sltCorrentista"),a.each(b,function(b,c){a("<option>").val(c.cpf).text(c.cpf).appendTo($select)})}),this.load(b+"conta/"+d,{cache:!1}).then(function(b){var c=a.parseJSON(b);a("#sltStatus").val(c[0].status),a("#sltCorrentista").val(c[0].correntista)})})}),this.bind("menu",function(){this.render("templates/sidebar.html",{items:this.items}).then(function(){a("#menu").empty()}).appendTo("#menu")})});a(function(){b.run("#/")})}(jQuery);