!function(a){var b=a.sammy("#main",function(){this.use("Mustache","html"),this.helpers({getTipoFuncionario:function(){var a=new Sammy.Store.SessionStorage("funcionario");return a.get("tipo")},limparStoreFunc:function(){var a=new Sammy.Store.SessionStorage("funcionario");a.clear("tipo"),a.clear("cpf")}}),this.around(function(b){var c=this;this.load("http://localhost:8080/TamanduaWS/api/autentica/menuFuncionario/"+this.getTipoFuncionario()).then(function(b){c.items=a.parseJSON(b)}).then(b)}),this.get("#/",function(a){a.app.swap(""),this.trigger("menu")}),this.get("#/logout",function(a){this.limparStoreFunc(),window.location.replace("http://localhost/Tamandua/src/")}),this.get("#/funcionario",function(b){b.app.swap(""),this.trigger("menu"),this.partial("templates/funcionario.html").then(function(){a("#example").DataTable({ajax:{url:"http://localhost:8080/TamanduaWS/api/funcionario",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/editarFunc/'+a+'">'+a+"</a>"}},{data:"nome"}]})})}),this.get("#/cadastroFunc",function(a){this.trigger("menu"),a.tipo="Cadastrar",this.partial("templates/formFuncionario.html")}),this.get("#/editarFunc/:cpf",function(b){b.app.swap(""),this.trigger("menu");var c=this.params.cpf;this.load("http://localhost:8080/TamanduaWS/api/funcionario/"+c,{cache:!1}).then(function(c){var d=a.parseJSON(c);b.cpf=d[0].cpf,b.nome=d[0].nome,b.tipo="Editar"}).partial("templates/formFuncionario.html")}),this.get("#/ctrAcesso",function(b){b.app.swap(""),this.trigger("menu"),this.partial("templates/ctrAcesso.html").then(function(){a("#tblCtrAcesso").DataTable({ajax:{url:"http://localhost:8080/TamanduaWS/api/ctracesso",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/editarCtrAcesso/'+a+'">'+a+"</a>"}},{data:"nomeFuncionario"},{data:"nomeStatus"},{data:"nomeTipo"}]})})}),this.get("#/editarCtrAcesso/:cpf",function(b){b.app.swap(""),this.trigger("menu");var c=this.params.cpf;b.cpf=c,this.partial("templates/formCtrAcesso.html").then(function(){this.load("http://localhost:8080/TamanduaWS/api/ctracesso/tipoacesso/",{json:!0}).then(function(b){$select=a("#sltTipo"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.nome).appendTo($select)})}),this.load("http://localhost:8080/TamanduaWS/api/ctracesso/status/",{json:!0}).then(function(b){$select=a("#sltStatus"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.status).appendTo($select)})}),this.load("http://localhost:8080/TamanduaWS/api/ctracesso/"+c,{json:!0}).then(function(b){a("#sltStatus").val(b[0].status),a("#sltTipo").val(b[0].tipo)})})}),this.post("#/editarCtrAcesso",function(){var b=a("form").find('input[name="cpf"]');b.removeAttr("disabled");a("form").serialize();b.attr("disabled","disabled"),data={cpf:a("form").find('input[name="cpf"]').val(),status:a("form").find('select[name="status"]').val(),tipo:a("form").find('select[name="tipo"]').val()},a.ajax({url:"http://localhost:8080/TamanduaWS/api/ctracesso",type:"PUT",data:data,success:function(a){window.location.replace("http://localhost/Tamandua/src/funcionario/#/ctrAcesso")}})}),this.get("#/desassociados",function(b){b.app.swap(""),this.trigger("menu"),this.partial("templates/desassociar.html").then(function(){a("#tblDesassociado").DataTable({ajax:{url:"http://localhost:8080/TamanduaWS/api/ctracesso/desassociados",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/associar/'+a+'">'+a+"</a>"}},{data:"nome"}]})})}),this.get("#/associar/:cpf",function(b){b.app.swap(""),this.trigger("menu"),b.cpf=this.params.cpf,this.partial("templates/formAssociar.html").then(function(b){this.load("http://localhost:8080/TamanduaWS/api/ctracesso/tipoacesso/",{json:!0}).then(function(b){$select=a("#sltTipo"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.nome).appendTo($select)})}),this.load("http://localhost:8080/TamanduaWS/api/ctracesso/status/",{json:!0}).then(function(b){$select=a("#sltStatus"),a.each(b,function(b,c){a("<option>").val(c.codigo).text(c.status).appendTo($select)})})})}),this.post("#/associar",function(){var b=a("form").find('input[name="cpf"]');b.removeAttr("disabled");var c=a("form").serialize();b.attr("disabled","disabled"),a.post("http://localhost:8080/TamanduaWS/api/ctracesso/associar",c,function(b){toastr.success("Funcionario "+a("form").find('input[name="cpf"]').val()+" foi associado a um perfil de acesso com sucesso!","Banco Tamandua")}).fail(function(b){result=a.parseJSON(b.responseText)})}),this.before({verb:"post",path:"#/cadastroFunc"},function(){var b=!0;return""===a("form").find('input[name="nome"]').val()?(toastr.error("O campo Nome está em branco!","Banco Tamandua"),b=!1):""===a("form").find('input[name="senha"]').val()&&(toastr.error("O campo Senha está em branco!","Banco Tamandua"),b=!1),b}),this.post("#/cadastroFunc",function(){var b=a("form").find('input[name="tipo"]').val();"Cadastrar"===b?a.post("http://localhost:8080/TamanduaWS/api/funcionario",a("form").serialize(),function(b){toastr.success("Funcionario "+a("form").find('input[name="nome"]').val()+" cadastro com sucesso!","Banco Tamandua")}).fail(function(b){result=a.parseJSON(b.responseText)}):"Editar"===b&&(data={cpf:a("form").find('input[name="cpf"]').val(),nome:a("form").find('input[name="nome"]').val(),senha:a("form").find('input[name="senha"]').val()},a.ajax({url:"http://localhost:8080/TamanduaWS/api/funcionario",type:"PUT",data:data,success:function(a){window.location.replace("http://localhost/Tamandua/src/funcionario/#/funcionario")}})),a("form").find("input[type=text], input[type=password]").val(""),a("form").find("input[name=cpf]").focus()}),this.get("#/correntista",function(b){b.app.swap(""),this.trigger("menu"),this.partial("templates/corrrentista.html").then(function(){a("#tblCorrentista").DataTable({ajax:{url:"http://localhost:8080/TamanduaWS/api/correntista",dataSrc:""},columns:[{data:"cpf",render:function(a,b,c,d){return'<a href="#/editarCorrentista/'+a+'">'+a+"</a>"}},{data:"nome"},{data:"endereco"},{data:"telefone"}]})})}),this.get("#/cadCorrentista",function(a){this.trigger("menu"),a.tipo="Cadastrar",this.partial("templates/formCorrentista.html")}),this.post("#/cadCorrentista",function(){var b=a("form").find('input[name="tipo"]').val();"Cadastrar"===b?a.post("http://localhost:8080/TamanduaWS/api/correntista",a("form").serialize(),function(b){toastr.success("Correntista "+a("form").find('input[name="cpf"]').val()+" cadastrado com sucesso!","Banco Tamandua"),a("form").find("input[type=text]").val(""),a("form").find("input[name=cpf]").focus()}).fail(function(b){result=a.parseJSON(b.responseText)}):"Editar"===b&&(data={cpf:a("form").find('input[name="cpf"]').val(),nome:a("form").find('input[name="nome"]').val(),endereco:a("form").find('input[name="endereco"]').val(),telefone:a("form").find('input[name="telefone"]').val()},a.ajax({url:"http://localhost:8080/TamanduaWS/api/correntista",type:"PUT",data:data,success:function(a){window.location.replace("http://localhost/Tamandua/src/funcionario/#/correntista")}}))}),this.get("#/editarCorrentista/:cpf",function(b){b.app.swap(""),this.trigger("menu");var c=this.params.cpf;this.load("http://localhost:8080/TamanduaWS/api/correntista/"+c,{cache:!1}).then(function(c){var d=a.parseJSON(c);b.cpf=d[0].cpf,b.nome=d[0].nome,b.endereco=d[0].endereco,b.telefone=d[0].telefone,b.tipo="Editar",b.desabilita="disabled"}).partial("templates/formCorrentista.html")}),this.get("#/saldo",function(a){this.trigger("menu"),this.partial("templates/formSaldo.html")}),this.get("#/saldo",function(a){this.trigger("menu"),this.partial("templates/formSaldo.html")}),this.post("#/saldo",function(b){var c=a("form").find('input[name="nroconta"]').val();this.load("http://localhost:8080/TamanduaWS/api/transacao/saldo/"+c).then(function(c){if(null!==c){var d=a.parseJSON(c);b.saldo="Saldo: "+d[0].saldo}else b.saldo="Não foi encontrado o saldo por falta de informação"}).partial("templates/formSaldo.html")}),this.get("#/extrato",function(a){this.trigger("menu"),this.partial("templates/formExtrato.html")}),this.post("#/extrato",function(b){var c=a("form").find('input[name="nroconta"]').val();this.load("http://localhost:8080/TamanduaWS/api/transacao/extrato/"+c,{json:!0}).then(function(a){for(var d in a){var e=new Date(a[d].data);a[d].fator=2===a[d].fator?"<i class='fa fa-plus'/>":"<i class='fa fa-minus'/>",a[d].data=e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes();var f="";switch(a[d].tipotransacao){case 1:f="Extrato";break;case 2:f="Transferência";break;case 3:f="Pagamento"}a[d].tipotransacao=f}if(null===a){var g="Nenhum Registro Encontrado com a conta ("+c+") informada!";b.msgm=g}else b.item=a}).partial("templates/formExtrato.html")}),this.bind("menu",function(){this.render("templates/sidebar.html",{items:this.items}).then(function(){a("#menu").empty()}).appendTo("#menu")})});a(function(){b.run("#/")})}(jQuery);